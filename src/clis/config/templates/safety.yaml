# =============================================================================
# CLIS Safety Configuration
# =============================================================================
# This file defines security rules to prevent dangerous operations.
# =============================================================================

# Blacklist Configuration
blacklist:
  # Enable blacklist checking
  # Block commands matching dangerous patterns
  enabled: true
  
  # Dangerous command patterns
  # These commands will be blocked immediately
  patterns:
    # File system destruction
    - "rm -rf /"
    - "rm -rf /*"
    - "rm -rf ~/*"
    - "mkfs"
    - "dd if=/dev/zero"
    - "dd if=/dev/random"
    - "> /dev/sda"
    - "> /dev/hda"
    
    # System modification
    - "chmod -R 777 /"
    - "chown -R"
    
    # Network attacks
    - ":(){ :|:& };:"  # Fork bomb
    
    # Package manager dangers
    - "npm install -g"  # Requires explicit confirmation
    - "pip install --break-system-packages"
  
  # Custom blacklist
  # Add your own dangerous patterns here
  custom: []

# Dry-Run Configuration
dry_run:
  # Enable dry-run by default
  # Show commands before executing them
  enabled: true
  
  # Force dry-run for high-risk operations
  # These operations always require preview, even if dry-run is disabled
  force_for:
    - delete     # Any delete operations
    - modify     # File modifications
    - system     # System-level changes
    - network    # Network operations
  
  # Auto-approve low-risk commands
  # Skip confirmation for read-only operations
  auto_approve_readonly: false

# Sudo Configuration
sudo:
  # Allow sudo commands
  # If false, all sudo commands are blocked
  allowed: false
  
  # Require explicit skill permission
  # Sudo commands only allowed if skill declares "allow_sudo: true"
  require_skill_permission: true
  
  # Always confirm sudo commands
  # Even if dry-run is disabled, sudo commands need confirmation
  always_confirm: true

# Risk Scoring
risk:
  # Enable risk scoring
  # Assign risk levels to commands automatically
  enabled: true
  
  # Risk thresholds
  thresholds:
    # Low risk (0-30): Read-only operations
    low: 30
    
    # Medium risk (31-60): Write operations
    medium: 60
    
    # High risk (61-90): Delete/modify operations
    high: 90
    
    # Critical risk (91-100): System-level operations
    critical: 100
  
  # Actions based on risk level
  actions:
    low: execute        # Execute directly (if dry-run disabled)
    medium: confirm     # Require user confirmation
    high: dry_run       # Force dry-run preview
    critical: block     # Block execution

# Confirmation Configuration
confirmation:
  # Timeout for user confirmation in seconds
  # Auto-reject if no response within this time
  timeout: 60
  
  # Default action on timeout
  # Options: reject, accept
  default_on_timeout: reject
  
  # Show risk score in confirmation prompt
  show_risk_score: true

# Logging Configuration
logging:
  # Log all executed commands
  # Keep a history of what was executed
  log_commands: true
  
  # Log blocked commands
  # Track potentially dangerous attempts
  log_blocked: true
  
  # Include timestamps
  include_timestamp: true
  
  # Include risk scores
  include_risk_score: true


# Context Management
context_management:
  # Enable intelligent context management
  enabled: true
  
  # Maximum observations to keep
  max_observations: 10
  
  # Compress when observations exceed this
  compression_threshold: 5
  
  # Always keep critical observations
  keep_critical: true
  
  # Always keep N most recent observations
  keep_recent: 3

# Auto-Approve Configuration
auto_approve:
  # Enable auto-approve for low-risk operations
  enabled: false
  
  # Maximum risk level to auto-approve
  # Options: low, medium, high
  max_risk_level: low
  
  # Only auto-approve read-only operations
  readonly_only: true
  
  # Record all auto-approve decisions
  record_decisions: true

# Agent Configuration
agent:
  # Maximum iterations for ReAct agent
  # Options: 
  max_iterations: auto
  
  # Safety limit for auto mode
  # Prevents infinite loops when Agent doesn't stop properly
  auto_iterations_base: 100
  
  # Note: auto_iterations_per_file is deprecated
  # In auto mode, Agent decides when to stop based on task completion
